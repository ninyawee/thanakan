{"config":{"lang":["th"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Thanakan","text":"<p>Thai Bank Utilities - \u0e40\u0e04\u0e23\u0e37\u0e48\u0e2d\u0e07\u0e21\u0e37\u0e2d\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e44\u0e17\u0e22</p>"},{"location":"#_1","title":"\u0e04\u0e27\u0e32\u0e21\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e2b\u0e25\u0e31\u0e01","text":"<ul> <li>QR Parser - \u0e2d\u0e48\u0e32\u0e19 QR Code \u0e08\u0e32\u0e01\u0e2a\u0e25\u0e34\u0e1b\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e44\u0e17\u0e22</li> <li>Bank API Clients - \u0e40\u0e0a\u0e37\u0e48\u0e2d\u0e21\u0e15\u0e48\u0e2d API \u0e02\u0e2d\u0e07 SCB \u0e41\u0e25\u0e30 KBank \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e2a\u0e25\u0e34\u0e1b</li> <li>Statement Parser - \u0e2d\u0e48\u0e32\u0e19\u0e41\u0e25\u0e30\u0e41\u0e1b\u0e25\u0e07 PDF Statement \u0e08\u0e32\u0e01 KBank, BBL \u0e41\u0e25\u0e30 SCB</li> <li>Mail Downloader - \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement PDF \u0e08\u0e32\u0e01 Gmail \u0e2d\u0e31\u0e15\u0e42\u0e19\u0e21\u0e31\u0e15\u0e34</li> <li>Accounting Export - \u0e2a\u0e48\u0e07\u0e2d\u0e2d\u0e01\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e44\u0e1b\u0e22\u0e31\u0e07\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e1a\u0e31\u0e0d\u0e0a\u0e35 (Peak)</li> </ul>"},{"location":"#package","title":"\u0e42\u0e04\u0e23\u0e07\u0e2a\u0e23\u0e49\u0e32\u0e07 Package","text":"<p>Thanakan \u0e40\u0e1b\u0e47\u0e19 monorepo \u0e1b\u0e23\u0e30\u0e01\u0e2d\u0e1a\u0e14\u0e49\u0e27\u0e22 package \u0e22\u0e48\u0e2d\u0e22\u0e17\u0e35\u0e48\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e41\u0e22\u0e01\u0e01\u0e31\u0e19\u0e44\u0e14\u0e49:</p> Package \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>thanakan</code> Package \u0e2b\u0e25\u0e31\u0e01 \u0e23\u0e27\u0e21 CLI \u0e41\u0e25\u0e30 re-export \u0e17\u0e38\u0e01 API <code>thanakan-qr</code> \u0e2d\u0e48\u0e32\u0e19 QR Code \u0e08\u0e32\u0e01\u0e2a\u0e25\u0e34\u0e1b\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 <code>thanakan-oauth</code> API clients \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a SCB \u0e41\u0e25\u0e30 KBank <code>thanakan-statement</code> \u0e2d\u0e48\u0e32\u0e19 PDF Statement (KBank, BBL, SCB) <code>thanakan-mail</code> \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement \u0e08\u0e32\u0e01 Gmail <code>thanakan-accounting</code> \u0e2a\u0e48\u0e07\u0e2d\u0e2d\u0e01\u0e44\u0e1b\u0e22\u0e31\u0e07\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e1a\u0e31\u0e0d\u0e0a\u0e35"},{"location":"#_2","title":"\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e14\u0e48\u0e27\u0e19","text":"<pre><code># \u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e17\u0e38\u0e01 feature\npip install thanakan\n\n# \u0e2b\u0e23\u0e37\u0e2d\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e40\u0e09\u0e1e\u0e32\u0e30\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23\npip install thanakan-qr        # QR parsing \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\npip install thanakan-oauth     # Bank APIs \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\npip install thanakan-statement # Statement parsing \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\n</code></pre>"},{"location":"#uvx","title":"\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e17\u0e31\u0e19\u0e17\u0e35\u0e14\u0e49\u0e27\u0e22 uvx (\u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07)","text":"<pre><code>uvx thanakan qr slip.png\nuvx thanakan statement parse statement.pdf\n</code></pre>"},{"location":"#_3","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":""},{"location":"#cli","title":"CLI","text":"<pre><code># \u0e2d\u0e48\u0e32\u0e19 QR \u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\u0e2a\u0e25\u0e34\u0e1b\nthanakan qr slip.png\n\n# \u0e2d\u0e48\u0e32\u0e19 Statement PDF\nthanakan statement parse statement.pdf\n\n# \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement \u0e08\u0e32\u0e01 Gmail\nthanakan mail download kbank\n</code></pre>"},{"location":"#python","title":"Python","text":"<pre><code>from thanakan import SlipQRData, SCBAPI\n\n# \u0e2d\u0e48\u0e32\u0e19 QR \u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\nfrom PIL import Image\nimage = Image.open(\"slip.png\")\ndata = SlipQRData.create_from_image(image)\nprint(data.payload.transaction_ref_id)\n\n# \u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e2a\u0e25\u0e34\u0e1b\u0e01\u0e31\u0e1a SCB API\napi = SCBAPI(app_key, app_secret, cert=cert_path)\nresult = await api.verify_slip(sending_bank_id, transaction_ref)\n</code></pre>"},{"location":"#_4","title":"\u0e40\u0e23\u0e34\u0e48\u0e21\u0e15\u0e49\u0e19\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":"<p>\u0e14\u0e39\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e41\u0e25\u0e30\u0e15\u0e31\u0e49\u0e07\u0e04\u0e48\u0e32\u0e17\u0e35\u0e48\u0e2b\u0e19\u0e49\u0e32 \u0e40\u0e23\u0e34\u0e48\u0e21\u0e15\u0e49\u0e19\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19</p> <p>\u0e42\u0e1b\u0e23\u0e40\u0e08\u0e01\u0e15\u0e4c\u0e19\u0e35\u0e49\u0e1e\u0e31\u0e12\u0e19\u0e32\u0e42\u0e14\u0e22 SAA-Coop</p>"},{"location":"getting-started/","title":"\u0e40\u0e23\u0e34\u0e48\u0e21\u0e15\u0e49\u0e19\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":""},{"location":"getting-started/#_2","title":"\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07","text":""},{"location":"getting-started/#pip","title":"\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e14\u0e49\u0e27\u0e22 pip","text":"<pre><code>pip install thanakan\n</code></pre>"},{"location":"getting-started/#uv","title":"\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e14\u0e49\u0e27\u0e22 uv","text":"<pre><code>uv add thanakan\n</code></pre>"},{"location":"getting-started/#global","title":"\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e41\u0e1a\u0e1a Global","text":"<pre><code># \u0e14\u0e49\u0e27\u0e22 uv\nuv tool install thanakan\n\n# \u0e14\u0e49\u0e27\u0e22 mise\nmise use -g pipx:thanakan\n\n# \u0e14\u0e49\u0e27\u0e22 pipx\npipx install thanakan\n</code></pre>"},{"location":"getting-started/#uvx","title":"\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e42\u0e14\u0e22\u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07 (uvx)","text":"<pre><code># \u0e23\u0e31\u0e19 CLI \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07\u0e14\u0e49\u0e27\u0e22 uvx\nuvx thanakan qr slip.png\nuvx thanakan statement parse statement.pdf\nuvx thanakan version\n</code></pre>"},{"location":"getting-started/#package","title":"\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e40\u0e09\u0e1e\u0e32\u0e30 package \u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23","text":"<pre><code># QR parsing \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\npip install thanakan-qr\n\n# Bank APIs \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\npip install thanakan-oauth\n\n# Statement parsing \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\npip install thanakan-statement\n\n# Mail download \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\npip install thanakan-mail\n\n# Accounting export \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\npip install thanakan-accounting\n</code></pre>"},{"location":"getting-started/#system-dependencies","title":"System Dependencies","text":""},{"location":"getting-started/#libzbar-qr-parsing","title":"libzbar (\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a QR parsing)","text":"<p>QR parsing \u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23 libzbar:</p> <p>=== \"Ubuntu/Debian\"</p> <pre><code>```bash\nsudo apt-get install libzbar0\n```\n</code></pre> <p>=== \"macOS\"</p> <pre><code>```bash\nbrew install zbar\n```\n</code></pre> <p>=== \"Windows\"</p> <pre><code>\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e08\u0e32\u0e01 [ZBar Windows](http://zbar.sourceforge.net/download.html)\n</code></pre>"},{"location":"getting-started/#_3","title":"\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07","text":"<pre><code>thanakan version\n</code></pre> <p>\u0e04\u0e27\u0e23\u0e41\u0e2a\u0e14\u0e07\u0e40\u0e27\u0e2d\u0e23\u0e4c\u0e0a\u0e31\u0e19\u0e1b\u0e31\u0e08\u0e08\u0e38\u0e1a\u0e31\u0e19 \u0e40\u0e0a\u0e48\u0e19 <code>thanakan 2.0.0</code></p>"},{"location":"getting-started/#quick-start","title":"Quick Start","text":""},{"location":"getting-started/#1-qr","title":"1. \u0e2d\u0e48\u0e32\u0e19 QR \u0e08\u0e32\u0e01\u0e2a\u0e25\u0e34\u0e1b\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19","text":"<pre><code># \u0e08\u0e32\u0e01\u0e44\u0e1f\u0e25\u0e4c\u0e23\u0e39\u0e1b\nthanakan qr slip.png\n\n# \u0e08\u0e32\u0e01 QR string \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07\nthanakan qr --raw \"00520102...\"\n</code></pre> <p>\u0e1c\u0e25\u0e25\u0e31\u0e1e\u0e18\u0e4c\u0e08\u0e30\u0e40\u0e1b\u0e47\u0e19 JSON:</p> <pre><code>{\n  \"raw_code\": \"00520102...\",\n  \"payload\": {\n    \"sending_bank_id\": \"014\",\n    \"transaction_ref_id\": \"2024010112345678901234\"\n  }\n}\n</code></pre>"},{"location":"getting-started/#2-statement-pdf","title":"2. \u0e2d\u0e48\u0e32\u0e19 Statement PDF","text":"<pre><code># \u0e2d\u0e48\u0e32\u0e19\u0e44\u0e1f\u0e25\u0e4c\u0e40\u0e14\u0e35\u0e22\u0e27\nthanakan statement parse statement.pdf\n\n# \u0e2d\u0e48\u0e32\u0e19\u0e17\u0e31\u0e49\u0e07 directory\nthanakan statement parse ./statements/\n\n# Export \u0e40\u0e1b\u0e47\u0e19 Excel\nthanakan statement export ./statements/ output.xlsx --format excel\n</code></pre>"},{"location":"getting-started/#3-python","title":"3. \u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e43\u0e19 Python","text":"<pre><code>from thanakan import SlipQRData\n\n# \u0e2d\u0e48\u0e32\u0e19 QR \u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\nfrom PIL import Image\nimage = Image.open(\"slip.png\")\ndata = SlipQRData.create_from_image(image)\n\nprint(f\"\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e1c\u0e39\u0e49\u0e42\u0e2d\u0e19: {data.payload.sending_bank_id}\")\nprint(f\"\u0e40\u0e25\u0e02\u0e2d\u0e49\u0e32\u0e07\u0e2d\u0e34\u0e07: {data.payload.transaction_ref_id}\")\n</code></pre>"},{"location":"getting-started/#_4","title":"\u0e02\u0e31\u0e49\u0e19\u0e15\u0e2d\u0e19\u0e16\u0e31\u0e14\u0e44\u0e1b","text":"<ul> <li>CLI Commands - \u0e14\u0e39\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07 CLI \u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14</li> <li>Libraries - \u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19 library \u0e43\u0e19 Python</li> </ul>"},{"location":"cli/","title":"CLI Commands","text":"<p>Thanakan CLI \u0e1b\u0e23\u0e30\u0e01\u0e2d\u0e1a\u0e14\u0e49\u0e27\u0e22\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07\u0e2b\u0e25\u0e31\u0e01 4 \u0e01\u0e25\u0e38\u0e48\u0e21:</p> \u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07 Alias \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>thanakan qr</code> - \u0e2d\u0e48\u0e32\u0e19 QR Code \u0e08\u0e32\u0e01\u0e2a\u0e25\u0e34\u0e1b\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19 <code>thanakan statement</code> <code>stm</code> \u0e2d\u0e48\u0e32\u0e19\u0e41\u0e25\u0e30\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23 Statement PDF <code>thanakan mail</code> - \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement \u0e08\u0e32\u0e01 Gmail <code>thanakan accounting</code> <code>acc</code> \u0e2a\u0e48\u0e07\u0e2d\u0e2d\u0e01\u0e44\u0e1b\u0e22\u0e31\u0e07\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e1a\u0e31\u0e0d\u0e0a\u0e35"},{"location":"cli/#_1","title":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e1e\u0e37\u0e49\u0e19\u0e10\u0e32\u0e19","text":"<pre><code># \u0e41\u0e2a\u0e14\u0e07 help\nthanakan --help\n\n# \u0e41\u0e2a\u0e14\u0e07 help \u0e02\u0e2d\u0e07\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07\u0e22\u0e48\u0e2d\u0e22\nthanakan qr --help\nthanakan statement --help\n\n# \u0e41\u0e2a\u0e14\u0e07\u0e40\u0e27\u0e2d\u0e23\u0e4c\u0e0a\u0e31\u0e19\nthanakan version\n</code></pre>"},{"location":"cli/#_2","title":"\u0e20\u0e32\u0e1e\u0e23\u0e27\u0e21\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07","text":""},{"location":"cli/#qr-command","title":"QR Command","text":"<p>\u0e2d\u0e48\u0e32\u0e19 QR Code \u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\u0e2a\u0e25\u0e34\u0e1b\u0e2b\u0e23\u0e37\u0e2d string:</p> <pre><code>thanakan qr slip.png\nthanakan qr --raw \"00520102...\"\n</code></pre> <p>\u0e14\u0e39\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14</p>"},{"location":"cli/#statement-commands","title":"Statement Commands","text":"<p>\u0e2d\u0e48\u0e32\u0e19, export, \u0e41\u0e25\u0e30\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a Statement PDF:</p> <pre><code>thanakan statement parse statement.pdf\nthanakan statement export ./pdfs/ output.xlsx --format excel\nthanakan statement validate ./pdfs/\n</code></pre> <p>\u0e14\u0e39\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14</p>"},{"location":"cli/#mail-commands","title":"Mail Commands","text":"<p>\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement \u0e08\u0e32\u0e01 Gmail:</p> <pre><code>thanakan mail auth\nthanakan mail download kbank\n</code></pre> <p>\u0e14\u0e39\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14</p>"},{"location":"cli/#accounting-commands","title":"Accounting Commands","text":"<p>\u0e2a\u0e48\u0e07\u0e2d\u0e2d\u0e01\u0e44\u0e1b\u0e22\u0e31\u0e07\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e1a\u0e31\u0e0d\u0e0a\u0e35:</p> <pre><code>thanakan accounting peak ./pdfs/ output.xlsx\n</code></pre> <p>\u0e14\u0e39\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14</p>"},{"location":"cli/accounting/","title":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07 accounting","text":"<p>\u0e2a\u0e48\u0e07\u0e2d\u0e2d\u0e01 Statement \u0e44\u0e1b\u0e22\u0e31\u0e07\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e1a\u0e31\u0e0d\u0e0a\u0e35</p>"},{"location":"cli/accounting/#alias","title":"Alias","text":"<pre><code>thanakan accounting ...\n# \u0e2b\u0e23\u0e37\u0e2d\nthanakan acc ...\n</code></pre>"},{"location":"cli/accounting/#_1","title":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07\u0e22\u0e48\u0e2d\u0e22","text":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07 \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>peak</code> \u0e2a\u0e48\u0e07\u0e2d\u0e2d\u0e01\u0e40\u0e1b\u0e47\u0e19\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a Peak Import Statement"},{"location":"cli/accounting/#peak","title":"peak","text":"<p>\u0e2a\u0e48\u0e07\u0e2d\u0e2d\u0e01 Statement \u0e40\u0e1b\u0e47\u0e19\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a import \u0e40\u0e02\u0e49\u0e32 Peak</p>"},{"location":"cli/accounting/#_2","title":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":"<pre><code>thanakan accounting peak [OPTIONS] PATH OUTPUT\n</code></pre>"},{"location":"cli/accounting/#arguments","title":"Arguments","text":"Argument \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>PATH</code> Path \u0e44\u0e1b\u0e22\u0e31\u0e07 PDF file \u0e2b\u0e23\u0e37\u0e2d directory <code>OUTPUT</code> Path \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a output Excel file (.xlsx)"},{"location":"cli/accounting/#options","title":"Options","text":"Option Short Default \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>--password</code> <code>-p</code> env <code>PDF_PASS</code> \u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19 PDF <code>--language</code> <code>-l</code> <code>en</code> \u0e20\u0e32\u0e29\u0e32\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23: <code>en</code>, <code>th</code> <code>--verbose</code> <code>-v</code> <code>false</code> \u0e41\u0e2a\u0e14\u0e07\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14"},{"location":"cli/accounting/#_3","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07","text":"<pre><code># Export \u0e44\u0e1f\u0e25\u0e4c\u0e40\u0e14\u0e35\u0e22\u0e27\nthanakan accounting peak statement.pdf peak_import.xlsx\n\n# Export \u0e17\u0e31\u0e49\u0e07 directory\nthanakan accounting peak ./statements/ peak_import.xlsx\n\n# \u0e43\u0e0a\u0e49 alias\nthanakan acc peak ./statements/ output.xlsx --verbose\n</code></pre>"},{"location":"cli/accounting/#peak-import","title":"\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a Peak Import","text":"<p>\u0e44\u0e1f\u0e25\u0e4c Excel \u0e17\u0e35\u0e48\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e21\u0e35\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e15\u0e32\u0e21 Peak Import Statement:</p> Column \u0e0a\u0e37\u0e48\u0e2d \u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a \u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07 A \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23 YYYYMMDD <code>20240115</code> B \u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e07\u0e34\u0e19 Number <code>-1500.00</code> (\u0e16\u0e2d\u0e19), <code>3000.00</code> (\u0e1d\u0e32\u0e01) C \u0e2b\u0e21\u0e32\u0e22\u0e40\u0e2b\u0e15\u0e38 Text <code>\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19 K PLUS - REF123456</code>"},{"location":"cli/accounting/#output","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07 Output","text":"\u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23 \u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e07\u0e34\u0e19 \u0e2b\u0e21\u0e32\u0e22\u0e40\u0e2b\u0e15\u0e38 20240115 -1500.00 \u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19 K PLUS - REF123456 20240116 3000.00 \u0e40\u0e07\u0e34\u0e19\u0e40\u0e02\u0e49\u0e32 - Transfer from BBL 20240117 -500.00 PromptPay - 0812345678"},{"location":"cli/accounting/#import-peak","title":"\u0e01\u0e32\u0e23 Import \u0e40\u0e02\u0e49\u0e32 Peak","text":"<ol> <li>\u0e40\u0e1b\u0e34\u0e14 Peak \u0e41\u0e25\u0e30\u0e44\u0e1b\u0e17\u0e35\u0e48\u0e2b\u0e19\u0e49\u0e32 Bank Statement</li> <li>\u0e40\u0e25\u0e37\u0e2d\u0e01 \"Import Statement\"</li> <li>\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e44\u0e1f\u0e25\u0e4c Excel \u0e17\u0e35\u0e48 export</li> <li>\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e41\u0e25\u0e30\u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e01\u0e32\u0e23 import</li> </ol>"},{"location":"cli/accounting/#_4","title":"\u0e2b\u0e21\u0e32\u0e22\u0e40\u0e2b\u0e15\u0e38","text":"<ul> <li>Output file \u0e08\u0e30\u0e21\u0e35 sheet \u0e41\u0e22\u0e01\u0e15\u0e48\u0e2d\u0e1a\u0e31\u0e0d\u0e0a\u0e35</li> <li>\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23\u0e16\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19\u0e08\u0e30\u0e41\u0e2a\u0e14\u0e07\u0e40\u0e1b\u0e47\u0e19\u0e08\u0e33\u0e19\u0e27\u0e19\u0e15\u0e34\u0e14\u0e25\u0e1a (-)</li> <li>\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23\u0e1d\u0e32\u0e01\u0e40\u0e07\u0e34\u0e19\u0e08\u0e30\u0e41\u0e2a\u0e14\u0e07\u0e40\u0e1b\u0e47\u0e19\u0e08\u0e33\u0e19\u0e27\u0e19\u0e1a\u0e27\u0e01 (+)</li> <li>\u0e2b\u0e21\u0e32\u0e22\u0e40\u0e2b\u0e15\u0e38\u0e23\u0e27\u0e21: \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 + \u0e0a\u0e48\u0e2d\u0e07\u0e17\u0e32\u0e07 + \u0e40\u0e25\u0e02\u0e40\u0e0a\u0e47\u0e04 + \u0e40\u0e25\u0e02\u0e2d\u0e49\u0e32\u0e07\u0e2d\u0e34\u0e07</li> </ul>"},{"location":"cli/mail/","title":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07 mail","text":"<p>\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement PDF \u0e08\u0e32\u0e01 Gmail</p>"},{"location":"cli/mail/#_1","title":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07\u0e22\u0e48\u0e2d\u0e22","text":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07 \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>auth</code> \u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e15\u0e31\u0e27\u0e15\u0e19\u0e01\u0e31\u0e1a Gmail (OAuth flow) <code>download</code> \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement PDF"},{"location":"cli/mail/#auth","title":"auth","text":"<p>\u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e15\u0e31\u0e27\u0e15\u0e19\u0e01\u0e31\u0e1a Gmail \u0e1c\u0e48\u0e32\u0e19 OAuth 2.0</p>"},{"location":"cli/mail/#_2","title":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":"<pre><code>thanakan mail auth [OPTIONS]\n</code></pre>"},{"location":"cli/mail/#options","title":"Options","text":"Option Short \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>--client-secret</code> <code>-c</code> Path \u0e44\u0e1b\u0e22\u0e31\u0e07 client_secret.json (\u0e2b\u0e23\u0e37\u0e2d env <code>GMAIL_CLIENT_SECRET</code>)"},{"location":"cli/mail/#_3","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07","text":"<pre><code># \u0e43\u0e0a\u0e49 path \u0e08\u0e32\u0e01 environment variable\nthanakan mail auth\n\n# \u0e23\u0e30\u0e1a\u0e38 path \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07\nthanakan mail auth --client-secret ./client_secret.json\n</code></pre>"},{"location":"cli/mail/#_4","title":"\u0e02\u0e31\u0e49\u0e19\u0e15\u0e2d\u0e19","text":"<ol> <li>\u0e40\u0e1b\u0e34\u0e14 browser \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a Google OAuth</li> <li>\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e1a\u0e31\u0e0d\u0e0a\u0e35 Gmail \u0e41\u0e25\u0e30\u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15\u0e2a\u0e34\u0e17\u0e18\u0e34\u0e4c</li> <li>Token \u0e08\u0e30\u0e16\u0e39\u0e01\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01\u0e17\u0e35\u0e48 <code>~/.thanakan/gmail_token.json</code></li> </ol>"},{"location":"cli/mail/#download","title":"download","text":"<p>\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement PDF \u0e08\u0e32\u0e01 email</p>"},{"location":"cli/mail/#_5","title":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":"<pre><code>thanakan mail download [OPTIONS] BANK\n</code></pre>"},{"location":"cli/mail/#arguments","title":"Arguments","text":"Argument \u0e04\u0e48\u0e32\u0e17\u0e35\u0e48\u0e23\u0e31\u0e1a \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>BANK</code> <code>kbank</code>, <code>bbl</code>, <code>scb</code>, <code>all</code> \u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14"},{"location":"cli/mail/#options_1","title":"Options","text":"Option Short Default \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>--output</code> <code>-o</code> <code>./downloads</code> Directory \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01 PDF <code>--max</code> <code>-m</code> <code>100</code> \u0e08\u0e33\u0e19\u0e27\u0e19 email \u0e2a\u0e39\u0e07\u0e2a\u0e38\u0e14\u0e17\u0e35\u0e48\u0e08\u0e30\u0e04\u0e49\u0e19\u0e2b\u0e32 <code>--parse</code> <code>-p</code> <code>false</code> Parse PDF \u0e17\u0e31\u0e19\u0e17\u0e35\u0e2b\u0e25\u0e31\u0e07\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 <code>--password</code> - env <code>PDF_PASS</code> \u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a parse PDF <code>--metadata/--no-metadata</code> - <code>true</code> \u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01 metadata \u0e40\u0e1b\u0e47\u0e19 JSON <code>--verbose</code> <code>-v</code> <code>false</code> \u0e41\u0e2a\u0e14\u0e07\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14"},{"location":"cli/mail/#_6","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07","text":"<pre><code># \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e08\u0e32\u0e01 KBank\nthanakan mail download kbank\n\n# \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e08\u0e32\u0e01 BBL \u0e1e\u0e23\u0e49\u0e2d\u0e21 parse\nthanakan mail download bbl --parse --output ./statements\n\n# \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e08\u0e32\u0e01\u0e17\u0e38\u0e01\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\nthanakan mail download all --max 50\n\n# \u0e44\u0e21\u0e48\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01 metadata\nthanakan mail download kbank --no-metadata\n</code></pre>"},{"location":"cli/mail/#output","title":"Output","text":"<pre><code>==================================================\nDownloading from KBANK\n==================================================\nKBANK: 15 PDFs from 12 emails\n\n==================================================\nTOTAL: 15 PDFs from 12 emails\nSaved to: ./downloads\n==================================================\n</code></pre>"},{"location":"cli/mail/#_7","title":"\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e17\u0e35\u0e48\u0e23\u0e2d\u0e07\u0e23\u0e31\u0e1a","text":"\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 Sender Email KBank <code>no-reply@kasikornbank.com</code> BBL <code>estatement@bangkokbank.com</code> SCB <code>scbestatement@scb.co.th</code>"},{"location":"cli/mail/#_8","title":"\u0e01\u0e32\u0e23\u0e15\u0e31\u0e49\u0e07\u0e04\u0e48\u0e32","text":""},{"location":"cli/mail/#1-google-cloud-project","title":"1. \u0e2a\u0e23\u0e49\u0e32\u0e07 Google Cloud Project","text":"<ol> <li>\u0e44\u0e1b\u0e17\u0e35\u0e48 Google Cloud Console</li> <li>\u0e2a\u0e23\u0e49\u0e32\u0e07 Project \u0e43\u0e2b\u0e21\u0e48</li> <li>\u0e40\u0e1b\u0e34\u0e14\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19 Gmail API</li> <li>\u0e2a\u0e23\u0e49\u0e32\u0e07 OAuth 2.0 Credentials (Desktop application)</li> <li>\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 <code>client_secret.json</code></li> </ol>"},{"location":"cli/mail/#2-environment-variables","title":"2. \u0e15\u0e31\u0e49\u0e07\u0e04\u0e48\u0e32 Environment Variables","text":"<pre><code># Path \u0e44\u0e1b\u0e22\u0e31\u0e07 client_secret.json (\u0e08\u0e33\u0e40\u0e1b\u0e47\u0e19)\nexport GMAIL_CLIENT_SECRET=/path/to/client_secret.json\n\n# Path \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e40\u0e01\u0e47\u0e1a token (optional)\nexport GMAIL_TOKEN_PATH=~/.thanakan/gmail_token.json\n\n# \u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19 PDF (optional)\nexport PDF_PASS=DDMMYYYY  # your birthdate\n</code></pre>"},{"location":"cli/mail/#3","title":"3. \u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e15\u0e31\u0e27\u0e15\u0e19","text":"<pre><code>thanakan mail auth\n</code></pre>"},{"location":"cli/mail/#metadata-format","title":"Metadata Format","text":"<p>\u0e40\u0e21\u0e37\u0e48\u0e2d\u0e40\u0e1b\u0e34\u0e14\u0e43\u0e0a\u0e49 <code>--metadata</code> \u0e08\u0e30\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e44\u0e1f\u0e25\u0e4c <code>metadata_&lt;bank&gt;.json</code>:</p> <pre><code>[\n  {\n    \"message_id\": \"abc123\",\n    \"subject\": \"E-Statement \u0e1b\u0e23\u0e30\u0e08\u0e33\u0e40\u0e14\u0e37\u0e2d\u0e19 \u0e21\u0e01\u0e23\u0e32\u0e04\u0e21 2024\",\n    \"date\": \"2024-02-01T10:00:00\",\n    \"sender\": \"no-reply@kasikornbank.com\",\n    \"downloaded_files\": [\"statement_202401.pdf\"],\n    \"skipped_attachments\": [],\n    \"errors\": []\n  }\n]\n</code></pre>"},{"location":"cli/qr/","title":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07 qr","text":"<p>\u0e2d\u0e48\u0e32\u0e19 QR Code \u0e08\u0e32\u0e01\u0e2a\u0e25\u0e34\u0e1b\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e44\u0e17\u0e22 \u0e15\u0e32\u0e21 SCB specification</p>"},{"location":"cli/qr/#_1","title":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":"<pre><code>thanakan qr [OPTIONS] [IMAGE]\n</code></pre>"},{"location":"cli/qr/#arguments","title":"Arguments","text":"Argument \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>IMAGE</code> Path \u0e44\u0e1b\u0e22\u0e31\u0e07\u0e44\u0e1f\u0e25\u0e4c\u0e23\u0e39\u0e1b\u0e2a\u0e25\u0e34\u0e1b (PNG, JPG, etc.)"},{"location":"cli/qr/#options","title":"Options","text":"Option Short \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>--raw</code> <code>-r</code> QR code string \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07 (\u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e43\u0e0a\u0e49\u0e23\u0e39\u0e1b) <code>--verbose</code> <code>-v</code> \u0e41\u0e2a\u0e14\u0e07\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e40\u0e15\u0e34\u0e21\u0e41\u0e25\u0e30\u0e02\u0e31\u0e49\u0e19\u0e15\u0e2d\u0e19\u0e16\u0e31\u0e14\u0e44\u0e1b"},{"location":"cli/qr/#_2","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07","text":""},{"location":"cli/qr/#_3","title":"\u0e2d\u0e48\u0e32\u0e19\u0e08\u0e32\u0e01\u0e44\u0e1f\u0e25\u0e4c\u0e23\u0e39\u0e1b","text":"<pre><code>thanakan qr slip.png\n</code></pre> <p>\u0e1c\u0e25\u0e25\u0e31\u0e1e\u0e18\u0e4c:</p> <pre><code>{\n  \"raw_code\": \"00520102...\",\n  \"payload\": {\n    \"sending_bank_id\": \"014\",\n    \"transaction_ref_id\": \"2024010112345678901234\"\n  }\n}\n</code></pre>"},{"location":"cli/qr/#qr-string","title":"\u0e2d\u0e48\u0e32\u0e19\u0e08\u0e32\u0e01 QR string \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07","text":"<pre><code>thanakan qr --raw \"00520102...\"\n</code></pre>"},{"location":"cli/qr/#_4","title":"\u0e41\u0e2a\u0e14\u0e07\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e40\u0e15\u0e34\u0e21","text":"<pre><code>thanakan qr slip.png --verbose\n</code></pre> <p>\u0e08\u0e30\u0e41\u0e2a\u0e14\u0e07\u0e02\u0e31\u0e49\u0e19\u0e15\u0e2d\u0e19\u0e16\u0e31\u0e14\u0e44\u0e1b\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e01\u0e32\u0e23\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e2a\u0e25\u0e34\u0e1b\u0e01\u0e31\u0e1a Bank API</p>"},{"location":"cli/qr/#output-format","title":"Output Format","text":"<p>\u0e1c\u0e25\u0e25\u0e31\u0e1e\u0e18\u0e4c\u0e40\u0e1b\u0e47\u0e19 JSON \u0e1b\u0e23\u0e30\u0e01\u0e2d\u0e1a\u0e14\u0e49\u0e27\u0e22:</p> Field \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>raw_code</code> QR code string \u0e14\u0e31\u0e49\u0e07\u0e40\u0e14\u0e34\u0e21 <code>payload.sending_bank_id</code> \u0e23\u0e2b\u0e31\u0e2a\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e1c\u0e39\u0e49\u0e42\u0e2d\u0e19 (3 \u0e2b\u0e25\u0e31\u0e01) <code>payload.transaction_ref_id</code> \u0e40\u0e25\u0e02\u0e2d\u0e49\u0e32\u0e07\u0e2d\u0e34\u0e07\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23"},{"location":"cli/qr/#_5","title":"\u0e23\u0e2b\u0e31\u0e2a\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23","text":"\u0e23\u0e2b\u0e31\u0e2a \u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 <code>002</code> \u0e01\u0e23\u0e38\u0e07\u0e40\u0e17\u0e1e (BBL) <code>004</code> \u0e01\u0e2a\u0e34\u0e01\u0e23\u0e44\u0e17\u0e22 (KBank) <code>006</code> \u0e01\u0e23\u0e38\u0e07\u0e44\u0e17\u0e22 (KTB) <code>011</code> \u0e17\u0e2b\u0e32\u0e23\u0e44\u0e17\u0e22\u0e18\u0e19\u0e0a\u0e32\u0e15 (TTB) <code>014</code> \u0e44\u0e17\u0e22\u0e1e\u0e32\u0e13\u0e34\u0e0a\u0e22\u0e4c (SCB) <code>025</code> \u0e01\u0e23\u0e38\u0e07\u0e28\u0e23\u0e35\u0e2d\u0e22\u0e38\u0e18\u0e22\u0e32 (BAY)"},{"location":"cli/qr/#error-handling","title":"Error Handling","text":""},{"location":"cli/qr/#qr-code","title":"\u0e44\u0e21\u0e48\u0e1e\u0e1a QR Code","text":"<pre><code>Error: Expected exactly one QR code in image\n</code></pre> <p>\u0e2a\u0e32\u0e40\u0e2b\u0e15\u0e38: - \u0e23\u0e39\u0e1b\u0e44\u0e21\u0e48\u0e21\u0e35 QR code - \u0e23\u0e39\u0e1b\u0e21\u0e35 QR code \u0e21\u0e32\u0e01\u0e01\u0e27\u0e48\u0e32 1 \u0e2d\u0e31\u0e19 - QR code \u0e40\u0e1a\u0e25\u0e2d\u0e2b\u0e23\u0e37\u0e2d\u0e40\u0e2a\u0e35\u0e22\u0e2b\u0e32\u0e22</p>"},{"location":"cli/qr/#qr_1","title":"QR \u0e44\u0e21\u0e48\u0e43\u0e0a\u0e48\u0e2a\u0e25\u0e34\u0e1b\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23","text":"<pre><code>Error: Not a valid bank slip QR\n</code></pre> <p>\u0e2a\u0e32\u0e40\u0e2b\u0e15\u0e38: - QR code \u0e44\u0e21\u0e48\u0e43\u0e0a\u0e48\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e2a\u0e25\u0e34\u0e1b\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e44\u0e17\u0e22 - \u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25 QR \u0e40\u0e2a\u0e35\u0e22\u0e2b\u0e32\u0e22 - CRC checksum \u0e44\u0e21\u0e48\u0e15\u0e23\u0e07</p>"},{"location":"cli/qr/#system-requirements","title":"System Requirements","text":"<p>\u0e15\u0e49\u0e2d\u0e07\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07 libzbar:</p> <pre><code># Ubuntu/Debian\nsudo apt-get install libzbar0\n\n# macOS\nbrew install zbar\n</code></pre>"},{"location":"cli/statement/","title":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07 statement","text":"<p>\u0e2d\u0e48\u0e32\u0e19\u0e41\u0e25\u0e30\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23 PDF Statement \u0e08\u0e32\u0e01\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 KBank, BBL \u0e41\u0e25\u0e30 SCB</p>"},{"location":"cli/statement/#alias","title":"Alias","text":"<pre><code>thanakan statement ...\n# \u0e2b\u0e23\u0e37\u0e2d\nthanakan stm ...\n</code></pre>"},{"location":"cli/statement/#_1","title":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07\u0e22\u0e48\u0e2d\u0e22","text":"\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07 \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>parse</code> \u0e2d\u0e48\u0e32\u0e19 Statement PDF \u0e41\u0e25\u0e30\u0e41\u0e2a\u0e14\u0e07\u0e1c\u0e25\u0e40\u0e1b\u0e47\u0e19 JSON <code>export</code> \u0e2d\u0e48\u0e32\u0e19\u0e41\u0e25\u0e30 export \u0e40\u0e1b\u0e47\u0e19\u0e44\u0e1f\u0e25\u0e4c (JSON, CSV, Excel) <code>validate</code> \u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e15\u0e48\u0e2d\u0e40\u0e19\u0e37\u0e48\u0e2d\u0e07\u0e02\u0e2d\u0e07\u0e22\u0e2d\u0e14\u0e40\u0e07\u0e34\u0e19"},{"location":"cli/statement/#parse","title":"parse","text":"<p>\u0e2d\u0e48\u0e32\u0e19 Statement PDF \u0e41\u0e25\u0e30\u0e41\u0e2a\u0e14\u0e07\u0e1c\u0e25\u0e40\u0e1b\u0e47\u0e19 JSON</p>"},{"location":"cli/statement/#_2","title":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":"<pre><code>thanakan statement parse [OPTIONS] PATH\n</code></pre>"},{"location":"cli/statement/#arguments","title":"Arguments","text":"Argument \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>PATH</code> Path \u0e44\u0e1b\u0e22\u0e31\u0e07 PDF file \u0e2b\u0e23\u0e37\u0e2d directory"},{"location":"cli/statement/#options","title":"Options","text":"Option Short \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>--password</code> <code>-p</code> \u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19 PDF (default: env <code>PDF_PASS</code>) <code>--verbose</code> <code>-v</code> \u0e41\u0e2a\u0e14\u0e07\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14\u0e01\u0e32\u0e23 parse"},{"location":"cli/statement/#_3","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07","text":"<pre><code># \u0e2d\u0e48\u0e32\u0e19\u0e44\u0e1f\u0e25\u0e4c\u0e40\u0e14\u0e35\u0e22\u0e27\nthanakan statement parse statement.pdf\n\n# \u0e2d\u0e48\u0e32\u0e19\u0e17\u0e31\u0e49\u0e07 directory\nthanakan statement parse ./statements/\n\n# \u0e23\u0e30\u0e1a\u0e38\u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19\nthanakan statement parse statement.pdf --password \"mypassword\"\n</code></pre>"},{"location":"cli/statement/#export","title":"export","text":"<p>\u0e2d\u0e48\u0e32\u0e19 Statement \u0e41\u0e25\u0e30 export \u0e40\u0e1b\u0e47\u0e19\u0e44\u0e1f\u0e25\u0e4c</p>"},{"location":"cli/statement/#_4","title":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":"<pre><code>thanakan statement export [OPTIONS] PATH OUTPUT\n</code></pre>"},{"location":"cli/statement/#arguments_1","title":"Arguments","text":"Argument \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>PATH</code> Path \u0e44\u0e1b\u0e22\u0e31\u0e07 PDF file \u0e2b\u0e23\u0e37\u0e2d directory <code>OUTPUT</code> Path \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a output (file \u0e2b\u0e23\u0e37\u0e2d directory)"},{"location":"cli/statement/#options_1","title":"Options","text":"Option Short \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>--format</code> <code>-f</code> \u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a output: <code>json</code>, <code>csv</code>, <code>excel</code> (default: <code>json</code>) <code>--password</code> <code>-p</code> \u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19 PDF <code>--language</code> <code>-l</code> \u0e20\u0e32\u0e29\u0e32\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a statement \u0e17\u0e35\u0e48\u0e0b\u0e49\u0e33\u0e01\u0e31\u0e19: <code>en</code>, <code>th</code> (default: <code>en</code>) <code>--verbose</code> <code>-v</code> \u0e41\u0e2a\u0e14\u0e07\u0e23\u0e32\u0e22\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14"},{"location":"cli/statement/#_5","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07","text":"<pre><code># Export \u0e40\u0e1b\u0e47\u0e19 JSON\nthanakan statement export ./pdfs/ output.json\n\n# Export \u0e40\u0e1b\u0e47\u0e19 Excel\nthanakan statement export ./pdfs/ output.xlsx --format excel\n\n# Export \u0e40\u0e1b\u0e47\u0e19 CSV (\u0e2b\u0e25\u0e32\u0e22\u0e44\u0e1f\u0e25\u0e4c\u0e15\u0e48\u0e2d\u0e1a\u0e31\u0e0d\u0e0a\u0e35)\nthanakan statement export ./pdfs/ ./csv_output/ --format csv\n\n# \u0e40\u0e25\u0e37\u0e2d\u0e01\u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22\nthanakan statement export ./pdfs/ output.json --language th\n</code></pre>"},{"location":"cli/statement/#output","title":"\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a Output","text":"Format \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>json</code> \u0e44\u0e1f\u0e25\u0e4c JSON \u0e40\u0e14\u0e35\u0e22\u0e27 \u0e23\u0e27\u0e21\u0e17\u0e38\u0e01\u0e1a\u0e31\u0e0d\u0e0a\u0e35 <code>csv</code> Directory \u0e17\u0e35\u0e48\u0e21\u0e35 CSV \u0e41\u0e22\u0e01\u0e15\u0e48\u0e2d\u0e1a\u0e31\u0e0d\u0e0a\u0e35 <code>excel</code> \u0e44\u0e1f\u0e25\u0e4c Excel \u0e40\u0e14\u0e35\u0e22\u0e27 \u0e41\u0e22\u0e01 sheet \u0e15\u0e48\u0e2d\u0e1a\u0e31\u0e0d\u0e0a\u0e35"},{"location":"cli/statement/#validate","title":"validate","text":"<p>\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e15\u0e48\u0e2d\u0e40\u0e19\u0e37\u0e48\u0e2d\u0e07\u0e02\u0e2d\u0e07\u0e22\u0e2d\u0e14\u0e40\u0e07\u0e34\u0e19\u0e23\u0e30\u0e2b\u0e27\u0e48\u0e32\u0e07 Statement</p>"},{"location":"cli/statement/#_6","title":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":"<pre><code>thanakan statement validate [OPTIONS] PATH\n</code></pre>"},{"location":"cli/statement/#arguments_2","title":"Arguments","text":"Argument \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>PATH</code> Path \u0e44\u0e1b\u0e22\u0e31\u0e07 PDF file \u0e2b\u0e23\u0e37\u0e2d directory"},{"location":"cli/statement/#options_2","title":"Options","text":"Option Short \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>--password</code> <code>-p</code> \u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19 PDF"},{"location":"cli/statement/#_7","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07","text":"<pre><code>thanakan statement validate ./statements/\n</code></pre>"},{"location":"cli/statement/#output_1","title":"Output","text":"<pre><code>[OK] 123-4-56789-0: 12 statements validated\n[FAIL] 987-6-54321-0: 1 issue(s) found\n  - statement_202401.pdf: expected opening 10000.00, got 9500.00\n</code></pre>"},{"location":"cli/statement/#_8","title":"\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e17\u0e35\u0e48\u0e23\u0e2d\u0e07\u0e23\u0e31\u0e1a","text":"\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 \u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a Statement KBank PDF \u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22\u0e41\u0e25\u0e30\u0e2d\u0e31\u0e07\u0e01\u0e24\u0e29 BBL PDF \u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22\u0e41\u0e25\u0e30\u0e2d\u0e31\u0e07\u0e01\u0e24\u0e29 SCB PDF \u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22\u0e41\u0e25\u0e30\u0e2d\u0e31\u0e07\u0e01\u0e24\u0e29"},{"location":"cli/statement/#_9","title":"\u0e2b\u0e21\u0e32\u0e22\u0e40\u0e2b\u0e15\u0e38","text":"<ul> <li>Statement PDF \u0e2a\u0e48\u0e27\u0e19\u0e43\u0e2b\u0e0d\u0e48\u0e21\u0e35\u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19\u0e40\u0e1b\u0e47\u0e19\u0e27\u0e31\u0e19\u0e40\u0e14\u0e37\u0e2d\u0e19\u0e1b\u0e35\u0e40\u0e01\u0e34\u0e14 (DDMMYYYY)</li> <li>\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e15\u0e31\u0e49\u0e07\u0e04\u0e48\u0e32 environment variable <code>PDF_PASS</code> \u0e41\u0e17\u0e19\u0e01\u0e32\u0e23\u0e23\u0e30\u0e1a\u0e38\u0e17\u0e38\u0e01\u0e04\u0e23\u0e31\u0e49\u0e07</li> </ul>"},{"location":"libraries/","title":"Libraries","text":"<p>Thanakan \u0e1b\u0e23\u0e30\u0e01\u0e2d\u0e1a\u0e14\u0e49\u0e27\u0e22 5 library \u0e17\u0e35\u0e48\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e41\u0e22\u0e01\u0e01\u0e31\u0e19\u0e44\u0e14\u0e49:</p> Library \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 thanakan-qr \u0e2d\u0e48\u0e32\u0e19 QR Code \u0e08\u0e32\u0e01\u0e2a\u0e25\u0e34\u0e1b\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19 thanakan-oauth API clients \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a SCB \u0e41\u0e25\u0e30 KBank thanakan-statement \u0e2d\u0e48\u0e32\u0e19 PDF Statement (KBank, BBL) thanakan-mail \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement \u0e08\u0e32\u0e01 Gmail thanakan-accounting \u0e2a\u0e48\u0e07\u0e2d\u0e2d\u0e01\u0e44\u0e1b\u0e22\u0e31\u0e07\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e1a\u0e31\u0e0d\u0e0a\u0e35"},{"location":"libraries/#_1","title":"\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07","text":""},{"location":"libraries/#_2","title":"\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14","text":"<pre><code>pip install thanakan\n</code></pre>"},{"location":"libraries/#_3","title":"\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e41\u0e22\u0e01","text":"<pre><code>pip install thanakan-qr\npip install thanakan-oauth\npip install thanakan-statement\npip install thanakan-mail\npip install thanakan-accounting\n</code></pre>"},{"location":"libraries/#import","title":"\u0e01\u0e32\u0e23 Import","text":""},{"location":"libraries/#package","title":"\u0e08\u0e32\u0e01 package \u0e2b\u0e25\u0e31\u0e01","text":"<pre><code>from thanakan import (\n    # QR\n    SlipQRData,\n    QrPayload,\n\n    # OAuth\n    SCBAPI,\n    KBankAPI,\n    SCBBaseURL,\n)\n</code></pre>"},{"location":"libraries/#package_1","title":"\u0e08\u0e32\u0e01 package \u0e22\u0e48\u0e2d\u0e22","text":"<pre><code>from thanakan_qr import SlipQRData, QrPayload\nfrom thanakan_oauth import SCBAPI, KBankAPI\nfrom thanakan_statement import parse_pdf, Statement, Transaction\nfrom thanakan_mail import GmailProvider, StatementDownloader\nfrom thanakan_accounting import export_to_peak\n</code></pre>"},{"location":"libraries/#workflow","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07 Workflow","text":""},{"location":"libraries/#qr","title":"\u0e2d\u0e48\u0e32\u0e19 QR \u0e41\u0e25\u0e30\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e2a\u0e25\u0e34\u0e1b","text":"<pre><code>from PIL import Image\nfrom thanakan import SlipQRData, SCBAPI\n\n# 1. \u0e2d\u0e48\u0e32\u0e19 QR \u0e08\u0e32\u0e01\u0e2a\u0e25\u0e34\u0e1b\nimage = Image.open(\"slip.png\")\nqr_data = SlipQRData.create_from_image(image)\n\n# 2. \u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e01\u0e31\u0e1a SCB API\napi = SCBAPI(\n    app_key=\"your_app_key\",\n    app_secret=\"your_app_secret\",\n    cert=\"/path/to/cert.pem\"\n)\n\nresult = await api.verify_slip(\n    qr_data.payload.sending_bank_id,\n    qr_data.payload.transaction_ref_id\n)\n\nprint(f\"\u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e07\u0e34\u0e19: {result.data.amount}\")\nprint(f\"\u0e1c\u0e39\u0e49\u0e42\u0e2d\u0e19: {result.data.sender.name}\")\n</code></pre>"},{"location":"libraries/#parse-statement","title":"\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e41\u0e25\u0e30 Parse Statement","text":"<pre><code>from thanakan_mail import GmailProvider, StatementDownloader, BANK_CONFIGS\nfrom thanakan_statement import parse_all_pdfs, consolidate_by_account\n\n# 1. \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e08\u0e32\u0e01 Gmail\nprovider = GmailProvider()\ndownloader = StatementDownloader(provider, BANK_CONFIGS[\"kbank\"], \"./downloads\")\ndownloader.download_statements(max_emails=100)\n\n# 2. Parse PDF\nstatements = parse_all_pdfs(\"./downloads\")\naccounts = consolidate_by_account(statements)\n\n# 3. \u0e14\u0e39\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\nfor account in accounts:\n    print(f\"\u0e1a\u0e31\u0e0d\u0e0a\u0e35: {account.account_number}\")\n    print(f\"\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23: {len(account.all_transactions)}\")\n</code></pre>"},{"location":"libraries/#export-peak","title":"Export \u0e44\u0e1b\u0e22\u0e31\u0e07 Peak","text":"<pre><code>from thanakan_statement import parse_all_pdfs, consolidate_by_account\nfrom thanakan_accounting import export_to_peak\n\n# Parse \u0e41\u0e25\u0e30 consolidate\nstatements = parse_all_pdfs(\"./statements\")\naccounts = consolidate_by_account(statements)\n\n# Export\nexport_to_peak(accounts, \"peak_import.xlsx\")\n</code></pre>"},{"location":"libraries/thanakan-accounting/","title":"thanakan-accounting","text":"<p>\u0e2a\u0e48\u0e07\u0e2d\u0e2d\u0e01 Statement \u0e44\u0e1b\u0e22\u0e31\u0e07\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e1a\u0e31\u0e0d\u0e0a\u0e35</p>"},{"location":"libraries/thanakan-accounting/#_1","title":"\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07","text":"<pre><code>pip install thanakan-accounting\n</code></pre>"},{"location":"libraries/thanakan-accounting/#quick-start","title":"Quick Start","text":"<pre><code>from thanakan_statement import parse_all_pdfs, consolidate_by_account\nfrom thanakan_accounting import export_to_peak\n\n# Parse statements\nstatements = parse_all_pdfs(\"./statements/\")\naccounts = consolidate_by_account(statements)\n\n# Export to Peak format\nexport_to_peak(accounts, \"peak_import.xlsx\")\n</code></pre>"},{"location":"libraries/thanakan-accounting/#_2","title":"\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e17\u0e35\u0e48\u0e23\u0e2d\u0e07\u0e23\u0e31\u0e1a","text":"\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21 Function \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 Peak <code>export_to_peak</code> Peak Import Statement format"},{"location":"libraries/thanakan-accounting/#peak-export","title":"Peak Export","text":""},{"location":"libraries/thanakan-accounting/#export_to_peak","title":"export_to_peak","text":"<p>Export \u0e2b\u0e25\u0e32\u0e22\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e40\u0e1b\u0e47\u0e19 Excel file (\u0e41\u0e22\u0e01 sheet \u0e15\u0e48\u0e2d\u0e1a\u0e31\u0e0d\u0e0a\u0e35)</p> <pre><code>from thanakan_accounting import export_to_peak\n\nexport_to_peak(accounts, \"peak_import.xlsx\")\n</code></pre> <p>Parameters:</p> Parameter Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>accounts</code> <code>list[Account]</code> \u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e17\u0e35\u0e48\u0e08\u0e30 export <code>output_path</code> <code>str \\| Path</code> Path \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a output Excel file"},{"location":"libraries/thanakan-accounting/#export_single_to_peak","title":"export_single_to_peak","text":"<p>Export \u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e40\u0e14\u0e35\u0e22\u0e27</p> <pre><code>from thanakan_accounting import export_single_to_peak\n\nexport_single_to_peak(accounts[0], \"peak_single.xlsx\")\n</code></pre>"},{"location":"libraries/thanakan-accounting/#peak-import-statement","title":"\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a Peak Import Statement","text":"<p>\u0e44\u0e1f\u0e25\u0e4c Excel \u0e17\u0e35\u0e48\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e21\u0e35\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e15\u0e32\u0e21 Peak Import Statement:</p> Column \u0e0a\u0e37\u0e48\u0e2d \u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a \u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07 A \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23 YYYYMMDD <code>20240115</code> B \u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e07\u0e34\u0e19 Number <code>-1500.00</code>, <code>3000.00</code> C \u0e2b\u0e21\u0e32\u0e22\u0e40\u0e2b\u0e15\u0e38 Text <code>\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19 K PLUS - REF123</code>"},{"location":"libraries/thanakan-accounting/#output","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07 Output","text":"\u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23 \u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e07\u0e34\u0e19 \u0e2b\u0e21\u0e32\u0e22\u0e40\u0e2b\u0e15\u0e38 20240115 -1500.00 \u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19 K PLUS - REF123456 20240116 3000.00 \u0e40\u0e07\u0e34\u0e19\u0e40\u0e02\u0e49\u0e32 - Transfer from BBL 20240117 -500.00 PromptPay - 0812345678"},{"location":"libraries/thanakan-accounting/#_3","title":"\u0e2b\u0e21\u0e32\u0e22\u0e40\u0e2b\u0e15\u0e38","text":"<ul> <li>\u0e16\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19: \u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e1b\u0e47\u0e19\u0e25\u0e1a (-)</li> <li>\u0e1d\u0e32\u0e01\u0e40\u0e07\u0e34\u0e19: \u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e1b\u0e47\u0e19\u0e1a\u0e27\u0e01 (+)</li> <li>\u0e2b\u0e21\u0e32\u0e22\u0e40\u0e2b\u0e15\u0e38: \u0e23\u0e27\u0e21\u0e08\u0e32\u0e01 description + channel + check number + reference</li> </ul>"},{"location":"libraries/thanakan-accounting/#_4","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":""},{"location":"libraries/thanakan-accounting/#full-pipeline","title":"Full Pipeline","text":"<pre><code>from thanakan_statement import parse_all_pdfs, consolidate_by_account\nfrom thanakan_accounting import export_to_peak\n\n# 1. Parse PDF statements\nstatements = parse_all_pdfs(\"./statements/\", password=\"DDMMYYYY\")\n\n# 2. Consolidate by account (remove duplicates)\naccounts = consolidate_by_account(statements, preferred_language=\"en\")\n\n# 3. Export to Peak format\nexport_to_peak(accounts, \"peak_import.xlsx\")\n\nprint(f\"Exported {len(accounts)} accounts\")\nfor account in accounts:\n    print(f\"  {account.account_number}: {len(account.all_transactions)} transactions\")\n</code></pre>"},{"location":"libraries/thanakan-accounting/#with-gmail-download","title":"With Gmail Download","text":"<pre><code>from thanakan_mail import GmailProvider, StatementDownloader, BANK_CONFIGS\nfrom thanakan_statement import parse_all_pdfs, consolidate_by_account\nfrom thanakan_accounting import export_to_peak\n\n# 1. Download from Gmail\nprovider = GmailProvider()\ndownloader = StatementDownloader(provider, BANK_CONFIGS[\"kbank\"], \"./downloads\")\ndownloader.download_statements(max_emails=100)\n\n# 2. Parse\nstatements = parse_all_pdfs(\"./downloads\")\naccounts = consolidate_by_account(statements)\n\n# 3. Export\nexport_to_peak(accounts, \"peak_import.xlsx\")\n</code></pre>"},{"location":"libraries/thanakan-accounting/#exporter","title":"\u0e40\u0e1e\u0e34\u0e48\u0e21 Exporter \u0e43\u0e2b\u0e21\u0e48","text":"<p>\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e40\u0e1e\u0e34\u0e48\u0e21 exporter \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e2d\u0e37\u0e48\u0e19\u0e44\u0e14\u0e49:</p> <pre><code># exporters/zoho.py\nfrom pathlib import Path\nfrom thanakan_statement import Account\n\ndef export_to_zoho(accounts: list[Account], output_path: Path | str) -&gt; None:\n    \"\"\"Export to Zoho Books format.\"\"\"\n    # Implementation here\n    pass\n</code></pre> <p>\u0e41\u0e25\u0e49\u0e27\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e43\u0e19 <code>__init__.py</code>:</p> <pre><code>from .exporters.zoho import export_to_zoho\n\n__all__ = [\n    \"export_to_peak\",\n    \"export_single_to_peak\",\n    \"export_to_zoho\",\n]\n</code></pre>"},{"location":"libraries/thanakan-accounting/#import-peak","title":"\u0e01\u0e32\u0e23 Import \u0e40\u0e02\u0e49\u0e32 Peak","text":"<ol> <li>\u0e40\u0e1b\u0e34\u0e14 Peak \u0e41\u0e25\u0e30\u0e44\u0e1b\u0e17\u0e35\u0e48 Bank Statement</li> <li>\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23</li> <li>\u0e04\u0e25\u0e34\u0e01 Import Statement</li> <li>\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e44\u0e1f\u0e25\u0e4c Excel \u0e17\u0e35\u0e48 export</li> <li>\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e41\u0e25\u0e30\u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e01\u0e32\u0e23 import</li> <li>\u0e17\u0e33 Bank Reconciliation \u0e15\u0e32\u0e21\u0e1b\u0e01\u0e15\u0e34</li> </ol>"},{"location":"libraries/thanakan-mail/","title":"thanakan-mail","text":"<p>\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement PDF \u0e08\u0e32\u0e01 Gmail</p>"},{"location":"libraries/thanakan-mail/#_1","title":"\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07","text":"<pre><code>pip install thanakan-mail\n</code></pre>"},{"location":"libraries/thanakan-mail/#quick-start","title":"Quick Start","text":"<pre><code>from thanakan_mail import GmailProvider, StatementDownloader, BANK_CONFIGS\n\n# \u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e15\u0e31\u0e27\u0e15\u0e19 (\u0e04\u0e23\u0e31\u0e49\u0e07\u0e41\u0e23\u0e01)\nprovider = GmailProvider(client_secret_path=\"./client_secret.json\")\nprovider.authenticate()\n\n# \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement\ndownloader = StatementDownloader(provider, BANK_CONFIGS[\"kbank\"], \"./downloads\")\nresults = downloader.download_statements(max_emails=100)\n</code></pre>"},{"location":"libraries/thanakan-mail/#gmail-api","title":"\u0e01\u0e32\u0e23\u0e15\u0e31\u0e49\u0e07\u0e04\u0e48\u0e32 Gmail API","text":""},{"location":"libraries/thanakan-mail/#1-google-cloud-project","title":"1. \u0e2a\u0e23\u0e49\u0e32\u0e07 Google Cloud Project","text":"<ol> <li>\u0e44\u0e1b\u0e17\u0e35\u0e48 Google Cloud Console</li> <li>\u0e2a\u0e23\u0e49\u0e32\u0e07 Project \u0e43\u0e2b\u0e21\u0e48</li> <li>\u0e44\u0e1b\u0e17\u0e35\u0e48 APIs &amp; Services &gt; Enable APIs</li> <li>\u0e04\u0e49\u0e19\u0e2b\u0e32\u0e41\u0e25\u0e30\u0e40\u0e1b\u0e34\u0e14\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19 Gmail API</li> </ol>"},{"location":"libraries/thanakan-mail/#2-oauth-credentials","title":"2. \u0e2a\u0e23\u0e49\u0e32\u0e07 OAuth Credentials","text":"<ol> <li>\u0e44\u0e1b\u0e17\u0e35\u0e48 APIs &amp; Services &gt; Credentials</li> <li>\u0e04\u0e25\u0e34\u0e01 Create Credentials &gt; OAuth client ID</li> <li>\u0e40\u0e25\u0e37\u0e2d\u0e01 Desktop application</li> <li>\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 JSON file (client_secret.json)</li> </ol>"},{"location":"libraries/thanakan-mail/#3-environment-variables","title":"3. \u0e15\u0e31\u0e49\u0e07\u0e04\u0e48\u0e32 Environment Variables","text":"<pre><code>export GMAIL_CLIENT_SECRET=/path/to/client_secret.json\nexport GMAIL_TOKEN_PATH=~/.thanakan/gmail_token.json  # optional\n</code></pre>"},{"location":"libraries/thanakan-mail/#gmailprovider","title":"GmailProvider","text":"<p>Provider \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e40\u0e0a\u0e37\u0e48\u0e2d\u0e21\u0e15\u0e48\u0e2d Gmail API</p>"},{"location":"libraries/thanakan-mail/#constructor","title":"Constructor","text":"<pre><code>GmailProvider(\n    client_secret_path: str | Path | None = None,\n    token_path: str | Path | None = None\n)\n</code></pre> Parameter Default \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>client_secret_path</code> env <code>GMAIL_CLIENT_SECRET</code> Path \u0e44\u0e1b\u0e22\u0e31\u0e07 client_secret.json <code>token_path</code> <code>~/.thanakan/gmail_token.json</code> Path \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e40\u0e01\u0e47\u0e1a OAuth token"},{"location":"libraries/thanakan-mail/#methods","title":"Methods","text":""},{"location":"libraries/thanakan-mail/#authenticate","title":"authenticate","text":"<p>\u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e15\u0e31\u0e27\u0e15\u0e19\u0e01\u0e31\u0e1a Gmail (\u0e40\u0e1b\u0e34\u0e14 browser)</p> <pre><code>provider = GmailProvider()\nprovider.authenticate()\n</code></pre>"},{"location":"libraries/thanakan-mail/#get_profile","title":"get_profile","text":"<p>\u0e14\u0e36\u0e07\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25 Gmail profile</p> <pre><code>profile = provider.get_profile()\nprint(f\"Email: {profile['emailAddress']}\")\nprint(f\"Messages: {profile['messagesTotal']}\")\n</code></pre>"},{"location":"libraries/thanakan-mail/#statementdownloader","title":"StatementDownloader","text":"<p>\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement PDF \u0e08\u0e32\u0e01 email</p>"},{"location":"libraries/thanakan-mail/#constructor_1","title":"Constructor","text":"<pre><code>StatementDownloader(\n    provider: EmailProvider,\n    bank_config: BankEmailConfig,\n    output_dir: str | Path\n)\n</code></pre> Parameter \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>provider</code> Email provider (\u0e40\u0e0a\u0e48\u0e19 <code>GmailProvider</code>) <code>bank_config</code> Configuration \u0e02\u0e2d\u0e07\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 <code>output_dir</code> Directory \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01 PDF"},{"location":"libraries/thanakan-mail/#methods_1","title":"Methods","text":""},{"location":"libraries/thanakan-mail/#download_statements","title":"download_statements","text":"<p>\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14 Statement \u0e08\u0e32\u0e01 email</p> <pre><code>results = downloader.download_statements(\n    max_emails=100,\n    verbose=True\n)\n\nfor result in results:\n    print(f\"Email: {result.message.subject}\")\n    print(f\"Downloaded: {result.downloaded_files}\")\n</code></pre> <p>Returns: <code>list[DownloadResult]</code></p>"},{"location":"libraries/thanakan-mail/#bank-configurations","title":"Bank Configurations","text":""},{"location":"libraries/thanakan-mail/#bank_configs","title":"BANK_CONFIGS","text":"<p>Dictionary \u0e02\u0e2d\u0e07 configuration \u0e17\u0e38\u0e01\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23</p> <pre><code>from thanakan_mail import BANK_CONFIGS\n\nkbank_config = BANK_CONFIGS[\"kbank\"]\nbbl_config = BANK_CONFIGS[\"bbl\"]\nscb_config = BANK_CONFIGS[\"scb\"]\n</code></pre>"},{"location":"libraries/thanakan-mail/#individual-configs","title":"Individual Configs","text":"<pre><code>from thanakan_mail import KBANK_CONFIG, BBL_CONFIG, SCB_CONFIG\n</code></pre> Config Sender Email <code>KBANK_CONFIG</code> <code>no-reply@kasikornbank.com</code> <code>BBL_CONFIG</code> <code>estatement@bangkokbank.com</code> <code>SCB_CONFIG</code> <code>scbestatement@scb.co.th</code>"},{"location":"libraries/thanakan-mail/#models","title":"Models","text":""},{"location":"libraries/thanakan-mail/#downloadresult","title":"DownloadResult","text":"<p>\u0e1c\u0e25\u0e01\u0e32\u0e23\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e08\u0e32\u0e01 email</p> Property Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>message</code> <code>EmailMessage</code> \u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25 email <code>downloaded_files</code> <code>list[str]</code> \u0e44\u0e1f\u0e25\u0e4c\u0e17\u0e35\u0e48\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08 <code>skipped_attachments</code> <code>list[str]</code> \u0e44\u0e1f\u0e25\u0e4c\u0e17\u0e35\u0e48\u0e02\u0e49\u0e32\u0e21 <code>errors</code> <code>list[str]</code> Error messages"},{"location":"libraries/thanakan-mail/#emailmessage","title":"EmailMessage","text":"<p>\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25 email</p> Property Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>message_id</code> <code>str</code> ID \u0e02\u0e2d\u0e07 email <code>subject</code> <code>str</code> \u0e2b\u0e31\u0e27\u0e02\u0e49\u0e2d <code>date</code> <code>datetime</code> \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48 <code>sender</code> <code>str</code> \u0e1c\u0e39\u0e49\u0e2a\u0e48\u0e07 <code>attachments</code> <code>list[EmailAttachment]</code> Attachments"},{"location":"libraries/thanakan-mail/#pdf-unlock-utilities","title":"PDF Unlock Utilities","text":""},{"location":"libraries/thanakan-mail/#unlock_pdf","title":"unlock_pdf","text":"<p>\u0e1b\u0e25\u0e14\u0e25\u0e47\u0e2d\u0e04 PDF \u0e17\u0e35\u0e48\u0e21\u0e35\u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19</p> <pre><code>from thanakan_mail import unlock_pdf\n\nunlock_pdf(\n    input_path=\"encrypted.pdf\",\n    output_path=\"decrypted.pdf\",\n    password=\"DDMMYYYY\"\n)\n</code></pre>"},{"location":"libraries/thanakan-mail/#unlock_pdfs","title":"unlock_pdfs","text":"<p>\u0e1b\u0e25\u0e14\u0e25\u0e47\u0e2d\u0e04 PDF \u0e2b\u0e25\u0e32\u0e22\u0e44\u0e1f\u0e25\u0e4c</p> <pre><code>from thanakan_mail import unlock_pdfs\n\nunlock_pdfs(\n    directory=\"./encrypted/\",\n    output_dir=\"./decrypted/\",\n    password=\"DDMMYYYY\"\n)\n</code></pre>"},{"location":"libraries/thanakan-mail/#is_pdf_encrypted","title":"is_pdf_encrypted","text":"<p>\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e27\u0e48\u0e32 PDF \u0e21\u0e35\u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19\u0e2b\u0e23\u0e37\u0e2d\u0e44\u0e21\u0e48</p> <pre><code>from thanakan_mail import is_pdf_encrypted\n\nif is_pdf_encrypted(\"statement.pdf\"):\n    print(\"PDF \u0e21\u0e35\u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19\")\n</code></pre>"},{"location":"libraries/thanakan-mail/#metadata","title":"Metadata","text":""},{"location":"libraries/thanakan-mail/#save_metadata","title":"save_metadata","text":"<p>\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01 metadata \u0e40\u0e1b\u0e47\u0e19 JSON</p> <pre><code>from thanakan_mail import save_metadata\n\nsave_metadata(results, \"metadata.json\")\n</code></pre>"},{"location":"libraries/thanakan-mail/#results_to_metadata","title":"results_to_metadata","text":"<p>\u0e41\u0e1b\u0e25\u0e07 results \u0e40\u0e1b\u0e47\u0e19 metadata list</p> <pre><code>from thanakan_mail import results_to_metadata\n\nmetadata = results_to_metadata(results)\n</code></pre>"},{"location":"libraries/thanakan-mail/#_2","title":"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19","text":""},{"location":"libraries/thanakan-mail/#_3","title":"\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e08\u0e32\u0e01\u0e17\u0e38\u0e01\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23","text":"<pre><code>from thanakan_mail import GmailProvider, StatementDownloader, BANK_CONFIGS\n\nprovider = GmailProvider()\n\nfor bank_name, bank_config in BANK_CONFIGS.items():\n    print(f\"Downloading from {bank_name}...\")\n    downloader = StatementDownloader(provider, bank_config, f\"./downloads/{bank_name}\")\n    results = downloader.download_statements(max_emails=50)\n    print(f\"  Downloaded {sum(len(r.downloaded_files) for r in results)} PDFs\")\n</code></pre>"},{"location":"libraries/thanakan-mail/#parse","title":"\u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\u0e41\u0e25\u0e30 Parse","text":"<pre><code>from thanakan_mail import GmailProvider, StatementDownloader, BANK_CONFIGS\nfrom thanakan_statement import parse_all_pdfs, consolidate_by_account\n\n# \u0e14\u0e32\u0e27\u0e19\u0e4c\u0e42\u0e2b\u0e25\u0e14\nprovider = GmailProvider()\ndownloader = StatementDownloader(provider, BANK_CONFIGS[\"kbank\"], \"./downloads\")\ndownloader.download_statements()\n\n# Parse\nstatements = parse_all_pdfs(\"./downloads\")\naccounts = consolidate_by_account(statements)\n\nfor account in accounts:\n    print(f\"{account.account_number}: {len(account.all_transactions)} transactions\")\n</code></pre>"},{"location":"libraries/thanakan-oauth/","title":"thanakan-oauth","text":"<p>API clients \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a SCB \u0e41\u0e25\u0e30 KBank</p>"},{"location":"libraries/thanakan-oauth/#_1","title":"\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07","text":"<pre><code>pip install thanakan-oauth\n</code></pre>"},{"location":"libraries/thanakan-oauth/#quick-start","title":"Quick Start","text":"<pre><code>from thanakan_oauth import SCBAPI, KBankAPI\n\n# SCB API\nscb = SCBAPI(\n    app_key=\"your_app_key\",\n    app_secret=\"your_app_secret\",\n    cert=\"/path/to/cert.pem\"\n)\n\n# KBank API\nkbank = KBankAPI(\n    consumer_id=\"your_consumer_id\",\n    consumer_secret=\"your_consumer_secret\",\n    cert=\"/path/to/cert.pem\"\n)\n</code></pre>"},{"location":"libraries/thanakan-oauth/#scbapi","title":"SCBAPI","text":"<p>API client \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a SCB Developer API</p>"},{"location":"libraries/thanakan-oauth/#constructor","title":"Constructor","text":"<pre><code>SCBAPI(\n    app_key: str,\n    app_secret: str,\n    biller_id: str | None = None,\n    merchant_id: str | None = None,\n    terminal_id: str | None = None,\n    cert: str | tuple[str, str] | None = None,\n    base_url: SCBBaseURL = SCBBaseURL.SANDBOX\n)\n</code></pre> Parameter \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>app_key</code> Application Key \u0e08\u0e32\u0e01 SCB Developer <code>app_secret</code> Application Secret <code>biller_id</code> Biller ID (\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a QR30) <code>merchant_id</code> Merchant ID <code>terminal_id</code> Terminal ID <code>cert</code> Path \u0e44\u0e1b\u0e22\u0e31\u0e07 mTLS certificate <code>base_url</code> <code>SCBBaseURL.SANDBOX</code> \u0e2b\u0e23\u0e37\u0e2d <code>SCBBaseURL.PRODUCTION</code>"},{"location":"libraries/thanakan-oauth/#methods","title":"Methods","text":""},{"location":"libraries/thanakan-oauth/#verify_slip","title":"<code>verify_slip</code>","text":"<p>\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e2a\u0e25\u0e34\u0e1b\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19</p> <pre><code>result = await scb.verify_slip(\n    sending_bank_id=\"014\",\n    transaction_ref_id=\"2024010112345678901234\"\n)\n\nif result.data:\n    print(f\"\u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e07\u0e34\u0e19: {result.data.amount}\")\n    print(f\"\u0e1c\u0e39\u0e49\u0e42\u0e2d\u0e19: {result.data.sender.name}\")\n</code></pre>"},{"location":"libraries/thanakan-oauth/#create_qr30","title":"<code>create_qr30</code>","text":"<p>\u0e2a\u0e23\u0e49\u0e32\u0e07 QR Code \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e23\u0e31\u0e1a\u0e0a\u0e33\u0e23\u0e30\u0e40\u0e07\u0e34\u0e19 (QR30)</p> <pre><code>result = await scb.create_qr30(\n    amount=100.00,\n    ref1=\"INV001\",\n    ref2=\"CUST001\",\n    ref3=\"ORDER001\"\n)\n\nprint(f\"QR Data: {result.data.qr_raw_data}\")\nprint(f\"QR Image: {result.data.qr_image}\")\n</code></pre>"},{"location":"libraries/thanakan-oauth/#query_transaction","title":"<code>query_transaction</code>","text":"<p>\u0e04\u0e49\u0e19\u0e2b\u0e32\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23 transaction</p> <pre><code>result = await scb.query_transaction(\n    biller_id=\"your_biller_id\",\n    reference1=\"INV001\",\n    transaction_date=\"20240115\"\n)\n</code></pre>"},{"location":"libraries/thanakan-oauth/#create_deeplink","title":"<code>create_deeplink</code>","text":"<p>\u0e2a\u0e23\u0e49\u0e32\u0e07 deeplink \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e0a\u0e33\u0e23\u0e30\u0e40\u0e07\u0e34\u0e19\u0e1c\u0e48\u0e32\u0e19 SCB Easy</p> <pre><code>result = await scb.create_deeplink(\n    amount=100.00,\n    ref1=\"INV001\",\n    ref2=\"CUST001\",\n    ref3=\"ORDER001\"\n)\n\nprint(f\"Deeplink: {result.data.deeplink_url}\")\n</code></pre>"},{"location":"libraries/thanakan-oauth/#get_deeplink","title":"<code>get_deeplink</code>","text":"<p>\u0e14\u0e36\u0e07\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25 deeplink \u0e17\u0e35\u0e48\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e44\u0e27\u0e49</p> <pre><code>result = await scb.get_deeplink(transaction_id=\"xxx\")\n</code></pre>"},{"location":"libraries/thanakan-oauth/#sync-methods","title":"Sync Methods","text":"<p>\u0e17\u0e38\u0e01 method \u0e21\u0e35 sync version \u0e42\u0e14\u0e22\u0e40\u0e15\u0e34\u0e21 <code>_sync</code>:</p> <pre><code># Async\nresult = await scb.verify_slip(...)\n\n# Sync\nresult = scb.verify_slip_sync(...)\n</code></pre>"},{"location":"libraries/thanakan-oauth/#kbankapi","title":"KBankAPI","text":"<p>API client \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a KBank Open API</p>"},{"location":"libraries/thanakan-oauth/#constructor_1","title":"Constructor","text":"<pre><code>KBankAPI(\n    consumer_id: str,\n    consumer_secret: str,\n    cert: str | tuple[str, str] | None = None\n)\n</code></pre> Parameter \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>consumer_id</code> Consumer ID \u0e08\u0e32\u0e01 KBank Developer <code>consumer_secret</code> Consumer Secret <code>cert</code> Path \u0e44\u0e1b\u0e22\u0e31\u0e07 mTLS certificate"},{"location":"libraries/thanakan-oauth/#methods_1","title":"Methods","text":""},{"location":"libraries/thanakan-oauth/#verify_slip_1","title":"<code>verify_slip</code>","text":"<p>\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e2a\u0e25\u0e34\u0e1b\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19</p> <pre><code># Async\nresult = await kbank.verify_slip(\n    sending_bank_id=\"014\",\n    transaction_ref_id=\"2024010112345678901234\"\n)\n\n# Sync\nresult = kbank.verify_slip_sync(\n    sending_bank_id=\"014\",\n    transaction_ref_id=\"2024010112345678901234\"\n)\n\nif result.data:\n    print(f\"\u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e07\u0e34\u0e19: {result.data.amount}\")\n    print(f\"\u0e1c\u0e39\u0e49\u0e42\u0e2d\u0e19: {result.data.sender.name}\")\n</code></pre>"},{"location":"libraries/thanakan-oauth/#slipdata","title":"SlipData","text":"<p>Response model \u0e17\u0e35\u0e48\u0e43\u0e0a\u0e49\u0e23\u0e48\u0e27\u0e21\u0e01\u0e31\u0e19\u0e23\u0e30\u0e2b\u0e27\u0e48\u0e32\u0e07 SCB \u0e41\u0e25\u0e30 KBank</p>"},{"location":"libraries/thanakan-oauth/#properties","title":"Properties","text":"Property Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>sender</code> <code>End</code> \u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e1c\u0e39\u0e49\u0e42\u0e2d\u0e19 <code>receiver</code> <code>End</code> \u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e1c\u0e39\u0e49\u0e23\u0e31\u0e1a <code>amount</code> <code>Decimal</code> \u0e08\u0e33\u0e19\u0e27\u0e19\u0e40\u0e07\u0e34\u0e19 <code>transaction_date_time</code> <code>datetime</code> \u0e27\u0e31\u0e19\u0e40\u0e27\u0e25\u0e32\u0e17\u0e33\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23 <code>transaction_id</code> <code>str</code> \u0e23\u0e2b\u0e31\u0e2a\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23"},{"location":"libraries/thanakan-oauth/#end","title":"End (\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e1c\u0e39\u0e49\u0e42\u0e2d\u0e19/\u0e1c\u0e39\u0e49\u0e23\u0e31\u0e1a)","text":"Property Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>name</code> <code>str</code> \u0e0a\u0e37\u0e48\u0e2d <code>account</code> <code>Account</code> \u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e1a\u0e31\u0e0d\u0e0a\u0e35 <code>proxy</code> <code>Proxy</code> \u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25 PromptPay (\u0e16\u0e49\u0e32\u0e21\u0e35)"},{"location":"libraries/thanakan-oauth/#mtls-certificate","title":"mTLS Certificate","text":"<p>\u0e17\u0e31\u0e49\u0e07 SCB \u0e41\u0e25\u0e30 KBank \u0e15\u0e49\u0e2d\u0e07\u0e43\u0e0a\u0e49 mTLS certificate \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a production:</p> <pre><code># Path \u0e40\u0e14\u0e35\u0e22\u0e27 (cert + key \u0e23\u0e27\u0e21\u0e01\u0e31\u0e19)\napi = SCBAPI(..., cert=\"/path/to/combined.pem\")\n\n# \u0e41\u0e22\u0e01 cert \u0e41\u0e25\u0e30 key\napi = SCBAPI(..., cert=(\"/path/to/cert.pem\", \"/path/to/key.pem\"))\n</code></pre>"},{"location":"libraries/thanakan-oauth/#error-handling","title":"Error Handling","text":"<pre><code>from thanakan_oauth import SCBAPI\n\napi = SCBAPI(...)\n\ntry:\n    result = await api.verify_slip(...)\nexcept ConnectionError as e:\n    print(f\"Connection error: {e}\")\n\n# \u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a response status\nif result.status.code != 1000:\n    print(f\"Error: {result.status.description}\")\n</code></pre>"},{"location":"libraries/thanakan-qr/","title":"thanakan-qr","text":"<p>\u0e2d\u0e48\u0e32\u0e19 QR Code \u0e08\u0e32\u0e01\u0e2a\u0e25\u0e34\u0e1b\u0e42\u0e2d\u0e19\u0e40\u0e07\u0e34\u0e19\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e44\u0e17\u0e22 \u0e15\u0e32\u0e21 SCB specification</p>"},{"location":"libraries/thanakan-qr/#_1","title":"\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07","text":"<pre><code>pip install thanakan-qr\n</code></pre>"},{"location":"libraries/thanakan-qr/#system-dependencies","title":"System Dependencies","text":"<p>\u0e15\u0e49\u0e2d\u0e07\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07 libzbar:</p> <pre><code># Ubuntu/Debian\nsudo apt-get install libzbar0\n\n# macOS\nbrew install zbar\n</code></pre>"},{"location":"libraries/thanakan-qr/#quick-start","title":"Quick Start","text":"<pre><code>from PIL import Image\nfrom thanakan_qr import SlipQRData\n\n# \u0e2d\u0e48\u0e32\u0e19\u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\nimage = Image.open(\"slip.png\")\ndata = SlipQRData.create_from_image(image)\n\nprint(f\"\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e1c\u0e39\u0e49\u0e42\u0e2d\u0e19: {data.payload.sending_bank_id}\")\nprint(f\"\u0e40\u0e25\u0e02\u0e2d\u0e49\u0e32\u0e07\u0e2d\u0e34\u0e07: {data.payload.transaction_ref_id}\")\n</code></pre>"},{"location":"libraries/thanakan-qr/#api-reference","title":"API Reference","text":""},{"location":"libraries/thanakan-qr/#slipqrdata","title":"SlipQRData","text":"<p>Class \u0e2b\u0e25\u0e31\u0e01\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a parse QR code \u0e08\u0e32\u0e01\u0e2a\u0e25\u0e34\u0e1b</p>"},{"location":"libraries/thanakan-qr/#class-methods","title":"Class Methods","text":""},{"location":"libraries/thanakan-qr/#create_from_imageimage-pilimage-slipqrdata","title":"<code>create_from_image(image: PIL.Image) -&gt; SlipQRData</code>","text":"<p>\u0e2d\u0e48\u0e32\u0e19 QR code \u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e</p> <pre><code>from PIL import Image\nfrom thanakan_qr import SlipQRData\n\nimage = Image.open(\"slip.png\")\ndata = SlipQRData.create_from_image(image)\n</code></pre> <p>Raises:</p> <ul> <li><code>expect_single_qrcode</code> - \u0e16\u0e49\u0e32\u0e23\u0e39\u0e1b\u0e44\u0e21\u0e48\u0e21\u0e35 QR \u0e2b\u0e23\u0e37\u0e2d\u0e21\u0e35\u0e21\u0e32\u0e01\u0e01\u0e27\u0e48\u0e32 1 \u0e2d\u0e31\u0e19</li> <li><code>not_bank_slip</code> - \u0e16\u0e49\u0e32 QR \u0e44\u0e21\u0e48\u0e43\u0e0a\u0e48\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e2a\u0e25\u0e34\u0e1b\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23</li> </ul>"},{"location":"libraries/thanakan-qr/#create_from_codecode-str-slipqrdata","title":"<code>create_from_code(code: str) -&gt; SlipQRData</code>","text":"<p>\u0e2d\u0e48\u0e32\u0e19\u0e08\u0e32\u0e01 QR code string \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07</p> <pre><code>from thanakan_qr import SlipQRData\n\ndata = SlipQRData.create_from_code(\"00520102...\")\n</code></pre> <p>Raises:</p> <ul> <li><code>not_bank_slip</code> - \u0e16\u0e49\u0e32 code \u0e44\u0e21\u0e48\u0e43\u0e0a\u0e48\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e2a\u0e25\u0e34\u0e1b\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23</li> </ul>"},{"location":"libraries/thanakan-qr/#properties","title":"Properties","text":"Property Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>raw_code</code> <code>str</code> QR code string \u0e14\u0e31\u0e49\u0e07\u0e40\u0e14\u0e34\u0e21 <code>payload</code> <code>QrPayload</code> \u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e17\u0e35\u0e48 parse \u0e41\u0e25\u0e49\u0e27"},{"location":"libraries/thanakan-qr/#qrpayload","title":"QrPayload","text":"<p>\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e17\u0e35\u0e48 parse \u0e08\u0e32\u0e01 QR code</p>"},{"location":"libraries/thanakan-qr/#properties_1","title":"Properties","text":"Property Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>sending_bank_id</code> <code>str</code> \u0e23\u0e2b\u0e31\u0e2a\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e1c\u0e39\u0e49\u0e42\u0e2d\u0e19 (3 \u0e2b\u0e25\u0e31\u0e01) <code>transaction_ref_id</code> <code>str</code> \u0e40\u0e25\u0e02\u0e2d\u0e49\u0e32\u0e07\u0e2d\u0e34\u0e07\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23"},{"location":"libraries/thanakan-qr/#exceptions","title":"Exceptions","text":""},{"location":"libraries/thanakan-qr/#not_bank_slip","title":"<code>not_bank_slip</code>","text":"<p>Raise \u0e40\u0e21\u0e37\u0e48\u0e2d QR code \u0e44\u0e21\u0e48\u0e43\u0e0a\u0e48\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e2a\u0e25\u0e34\u0e1b\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23</p> <pre><code>from thanakan_qr import SlipQRData, not_bank_slip\n\ntry:\n    data = SlipQRData.create_from_code(\"invalid\")\nexcept not_bank_slip as e:\n    print(f\"\u0e44\u0e21\u0e48\u0e43\u0e0a\u0e48\u0e2a\u0e25\u0e34\u0e1b\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23: {e}\")\n</code></pre>"},{"location":"libraries/thanakan-qr/#expect_single_qrcode","title":"<code>expect_single_qrcode</code>","text":"<p>Raise \u0e40\u0e21\u0e37\u0e48\u0e2d\u0e23\u0e39\u0e1b\u0e44\u0e21\u0e48\u0e21\u0e35 QR code \u0e2b\u0e23\u0e37\u0e2d\u0e21\u0e35\u0e21\u0e32\u0e01\u0e01\u0e27\u0e48\u0e32 1 \u0e2d\u0e31\u0e19</p> <pre><code>from thanakan_qr import SlipQRData, expect_single_qrcode\n\ntry:\n    data = SlipQRData.create_from_image(image)\nexcept expect_single_qrcode:\n    print(\"\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23 QR code 1 \u0e2d\u0e31\u0e19\u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\")\n</code></pre>"},{"location":"libraries/thanakan-qr/#_2","title":"\u0e23\u0e2b\u0e31\u0e2a\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23","text":"\u0e23\u0e2b\u0e31\u0e2a \u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 <code>002</code> \u0e01\u0e23\u0e38\u0e07\u0e40\u0e17\u0e1e (BBL) <code>004</code> \u0e01\u0e2a\u0e34\u0e01\u0e23\u0e44\u0e17\u0e22 (KBank) <code>006</code> \u0e01\u0e23\u0e38\u0e07\u0e44\u0e17\u0e22 (KTB) <code>011</code> \u0e17\u0e2b\u0e32\u0e23\u0e44\u0e17\u0e22\u0e18\u0e19\u0e0a\u0e32\u0e15 (TTB) <code>014</code> \u0e44\u0e17\u0e22\u0e1e\u0e32\u0e13\u0e34\u0e0a\u0e22\u0e4c (SCB) <code>025</code> \u0e01\u0e23\u0e38\u0e07\u0e28\u0e23\u0e35\u0e2d\u0e22\u0e38\u0e18\u0e22\u0e32 (BAY)"},{"location":"libraries/thanakan-qr/#export-to-json","title":"Export to JSON","text":"<pre><code>from thanakan_qr import SlipQRData\n\ndata = SlipQRData.create_from_code(\"00520102...\")\n\n# Export \u0e40\u0e1b\u0e47\u0e19 JSON\njson_str = data.model_dump_json(indent=2)\nprint(json_str)\n\n# Export \u0e40\u0e1b\u0e47\u0e19 dict\ndict_data = data.model_dump()\n</code></pre> <p>Output:</p> <pre><code>{\n  \"raw_code\": \"00520102...\",\n  \"payload\": {\n    \"sending_bank_id\": \"014\",\n    \"transaction_ref_id\": \"2024010112345678901234\"\n  }\n}\n</code></pre>"},{"location":"libraries/thanakan-statement/","title":"thanakan-statement","text":"<p>\u0e2d\u0e48\u0e32\u0e19\u0e41\u0e25\u0e30\u0e41\u0e1b\u0e25\u0e07 PDF Statement \u0e08\u0e32\u0e01\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 KBank, BBL \u0e41\u0e25\u0e30 SCB</p>"},{"location":"libraries/thanakan-statement/#_1","title":"\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07","text":"<pre><code>pip install thanakan-statement\n</code></pre>"},{"location":"libraries/thanakan-statement/#quick-start","title":"Quick Start","text":"<pre><code>from thanakan_statement import parse_pdf, parse_all_pdfs\n\n# \u0e2d\u0e48\u0e32\u0e19\u0e44\u0e1f\u0e25\u0e4c\u0e40\u0e14\u0e35\u0e22\u0e27\nstatement = parse_pdf(\"statement.pdf\", password=\"DDMMYYYY\")\nprint(f\"\u0e1a\u0e31\u0e0d\u0e0a\u0e35: {statement.account_number}\")\nprint(f\"\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23: {len(statement.transactions)}\")\n\n# \u0e2d\u0e48\u0e32\u0e19\u0e17\u0e31\u0e49\u0e07 directory\nstatements = parse_all_pdfs(\"./statements/\", password=\"DDMMYYYY\")\n</code></pre>"},{"location":"libraries/thanakan-statement/#parsing","title":"Parsing","text":""},{"location":"libraries/thanakan-statement/#parse_pdf","title":"parse_pdf","text":"<p>\u0e2d\u0e48\u0e32\u0e19 Statement PDF \u0e44\u0e1f\u0e25\u0e4c\u0e40\u0e14\u0e35\u0e22\u0e27</p> <pre><code>from thanakan_statement import parse_pdf\n\nstatement = parse_pdf(\n    pdf_path=\"statement.pdf\",\n    password=\"DDMMYYYY\"  # default \u0e08\u0e32\u0e01 env PDF_PASS\n)\n</code></pre> <p>Parameters:</p> Parameter Type Default \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>pdf_path</code> <code>str \\| Path</code> - Path \u0e44\u0e1b\u0e22\u0e31\u0e07 PDF file <code>password</code> <code>str</code> env <code>PDF_PASS</code> \u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19 PDF <p>Returns: <code>Statement</code></p>"},{"location":"libraries/thanakan-statement/#parse_all_pdfs","title":"parse_all_pdfs","text":"<p>\u0e2d\u0e48\u0e32\u0e19 Statement PDF \u0e17\u0e31\u0e49\u0e07 directory</p> <pre><code>from thanakan_statement import parse_all_pdfs\n\nstatements = parse_all_pdfs(\n    directory=\"./statements/\",\n    password=\"DDMMYYYY\"\n)\n</code></pre> <p>Returns: <code>list[Statement]</code></p>"},{"location":"libraries/thanakan-statement/#consolidation","title":"Consolidation","text":""},{"location":"libraries/thanakan-statement/#consolidate_by_account","title":"consolidate_by_account","text":"<p>\u0e23\u0e27\u0e21 statements \u0e2b\u0e25\u0e32\u0e22\u0e44\u0e1f\u0e25\u0e4c\u0e15\u0e32\u0e21\u0e1a\u0e31\u0e0d\u0e0a\u0e35 \u0e41\u0e25\u0e30\u0e25\u0e1a\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23\u0e0b\u0e49\u0e33</p> <pre><code>from thanakan_statement import parse_all_pdfs, consolidate_by_account\n\nstatements = parse_all_pdfs(\"./statements/\")\naccounts = consolidate_by_account(\n    statements,\n    preferred_language=\"en\"  # \u0e40\u0e25\u0e37\u0e2d\u0e01 statement \u0e20\u0e32\u0e29\u0e32\u0e2d\u0e31\u0e07\u0e01\u0e24\u0e29\u0e16\u0e49\u0e32\u0e0b\u0e49\u0e33\u0e01\u0e31\u0e19\n)\n\nfor account in accounts:\n    print(f\"\u0e1a\u0e31\u0e0d\u0e0a\u0e35: {account.account_number}\")\n    print(f\"\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14: {len(account.all_transactions)}\")\n</code></pre> <p>Parameters:</p> Parameter Type Default \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>statements</code> <code>list[Statement]</code> - Statement \u0e17\u0e35\u0e48\u0e08\u0e30\u0e23\u0e27\u0e21 <code>preferred_language</code> <code>str</code> <code>\"en\"</code> \u0e20\u0e32\u0e29\u0e32\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23 (<code>\"en\"</code> \u0e2b\u0e23\u0e37\u0e2d <code>\"th\"</code>) <p>Returns: <code>list[Account]</code></p>"},{"location":"libraries/thanakan-statement/#validate_balance_continuity","title":"validate_balance_continuity","text":"<p>\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e15\u0e48\u0e2d\u0e40\u0e19\u0e37\u0e48\u0e2d\u0e07\u0e02\u0e2d\u0e07\u0e22\u0e2d\u0e14\u0e40\u0e07\u0e34\u0e19</p> <pre><code>from thanakan_statement import parse_all_pdfs, validate_balance_continuity\n\nstatements = parse_all_pdfs(\"./statements/\")\n\n# \u0e40\u0e23\u0e35\u0e22\u0e07 statements \u0e15\u0e32\u0e21\u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\nstatements.sort(key=lambda s: s.statement_period_start)\n\nis_valid, issues = validate_balance_continuity(statements)\n\nif not is_valid:\n    for issue in issues:\n        print(f\"\u0e1b\u0e31\u0e0d\u0e2b\u0e32: {issue.statement.source_pdf}\")\n        print(f\"  \u0e04\u0e32\u0e14\u0e2b\u0e27\u0e31\u0e07: {issue.expected_opening}\")\n        print(f\"  \u0e08\u0e23\u0e34\u0e07: {issue.actual_opening}\")\n</code></pre>"},{"location":"libraries/thanakan-statement/#export","title":"Export","text":""},{"location":"libraries/thanakan-statement/#export_to_json","title":"export_to_json","text":"<p>Export \u0e40\u0e1b\u0e47\u0e19 JSON file</p> <pre><code>from thanakan_statement import consolidate_by_account, export_to_json\n\naccounts = consolidate_by_account(statements)\nexport_to_json(accounts, \"output.json\")\n</code></pre>"},{"location":"libraries/thanakan-statement/#export_to_csv","title":"export_to_csv","text":"<p>Export \u0e40\u0e1b\u0e47\u0e19 CSV files (\u0e41\u0e22\u0e01\u0e15\u0e48\u0e2d\u0e1a\u0e31\u0e0d\u0e0a\u0e35)</p> <pre><code>from thanakan_statement import consolidate_by_account, export_to_csv\n\naccounts = consolidate_by_account(statements)\nexport_to_csv(accounts, \"./csv_output/\")\n# \u0e2a\u0e23\u0e49\u0e32\u0e07: ./csv_output/123-4-56789-0.csv, etc.\n</code></pre>"},{"location":"libraries/thanakan-statement/#export_to_excel","title":"export_to_excel","text":"<p>Export \u0e40\u0e1b\u0e47\u0e19 Excel file (\u0e41\u0e22\u0e01 sheet \u0e15\u0e48\u0e2d\u0e1a\u0e31\u0e0d\u0e0a\u0e35)</p> <pre><code>from thanakan_statement import consolidate_by_account, export_to_excel\n\naccounts = consolidate_by_account(statements)\nexport_to_excel(accounts, \"output.xlsx\")\n</code></pre>"},{"location":"libraries/thanakan-statement/#models","title":"Models","text":""},{"location":"libraries/thanakan-statement/#statement","title":"Statement","text":"<p>\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25 Statement \u0e08\u0e32\u0e01 PDF \u0e44\u0e1f\u0e25\u0e4c\u0e40\u0e14\u0e35\u0e22\u0e27</p> Property Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>account_number</code> <code>str</code> \u0e40\u0e25\u0e02\u0e1a\u0e31\u0e0d\u0e0a\u0e35 <code>account_name</code> <code>str</code> \u0e0a\u0e37\u0e48\u0e2d\u0e1a\u0e31\u0e0d\u0e0a\u0e35 <code>bank</code> <code>str</code> \u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 (<code>kbank</code>, <code>bbl</code>) <code>language</code> <code>str</code> \u0e20\u0e32\u0e29\u0e32 (<code>en</code>, <code>th</code>) <code>statement_period_start</code> <code>date</code> \u0e27\u0e31\u0e19\u0e40\u0e23\u0e34\u0e48\u0e21\u0e15\u0e49\u0e19 statement <code>statement_period_end</code> <code>date</code> \u0e27\u0e31\u0e19\u0e2a\u0e34\u0e49\u0e19\u0e2a\u0e38\u0e14 statement <code>opening_balance</code> <code>Decimal</code> \u0e22\u0e2d\u0e14\u0e22\u0e01\u0e21\u0e32 <code>closing_balance</code> <code>Decimal</code> \u0e22\u0e2d\u0e14\u0e22\u0e01\u0e44\u0e1b <code>transactions</code> <code>list[Transaction]</code> \u0e23\u0e32\u0e22\u0e01\u0e32\u0e23 transactions <code>source_pdf</code> <code>str</code> \u0e0a\u0e37\u0e48\u0e2d\u0e44\u0e1f\u0e25\u0e4c PDF \u0e15\u0e49\u0e19\u0e09\u0e1a\u0e31\u0e1a"},{"location":"libraries/thanakan-statement/#transaction","title":"Transaction","text":"<p>\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23 transaction</p> Property Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>date</code> <code>date</code> \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48 <code>time</code> <code>time \\| None</code> \u0e40\u0e27\u0e25\u0e32 (\u0e16\u0e49\u0e32\u0e21\u0e35) <code>description</code> <code>str</code> \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>channel</code> <code>str \\| None</code> \u0e0a\u0e48\u0e2d\u0e07\u0e17\u0e32\u0e07 <code>withdrawal</code> <code>Decimal \\| None</code> \u0e22\u0e2d\u0e14\u0e16\u0e2d\u0e19 <code>deposit</code> <code>Decimal \\| None</code> \u0e22\u0e2d\u0e14\u0e1d\u0e32\u0e01 <code>balance</code> <code>Decimal</code> \u0e22\u0e2d\u0e14\u0e04\u0e07\u0e40\u0e2b\u0e25\u0e37\u0e2d <code>check_number</code> <code>str \\| None</code> \u0e40\u0e25\u0e02\u0e40\u0e0a\u0e47\u0e04 <code>reference</code> <code>str \\| None</code> \u0e40\u0e25\u0e02\u0e2d\u0e49\u0e32\u0e07\u0e2d\u0e34\u0e07"},{"location":"libraries/thanakan-statement/#account","title":"Account","text":"<p>\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e17\u0e35\u0e48\u0e23\u0e27\u0e21 statements \u0e2b\u0e25\u0e32\u0e22\u0e44\u0e1f\u0e25\u0e4c\u0e41\u0e25\u0e49\u0e27</p> Property Type \u0e04\u0e33\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22 <code>account_number</code> <code>str</code> \u0e40\u0e25\u0e02\u0e1a\u0e31\u0e0d\u0e0a\u0e35 <code>account_name</code> <code>str</code> \u0e0a\u0e37\u0e48\u0e2d\u0e1a\u0e31\u0e0d\u0e0a\u0e35 <code>bank</code> <code>str</code> \u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 <code>statements</code> <code>list[Statement]</code> Statement \u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14 <code>all_transactions</code> <code>list[Transaction]</code> Transaction \u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14 (\u0e44\u0e21\u0e48\u0e0b\u0e49\u0e33)"},{"location":"libraries/thanakan-statement/#_2","title":"\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23\u0e17\u0e35\u0e48\u0e23\u0e2d\u0e07\u0e23\u0e31\u0e1a","text":"\u0e18\u0e19\u0e32\u0e04\u0e32\u0e23 \u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a Statement \u0e20\u0e32\u0e29\u0e32 KBank PDF \u0e44\u0e17\u0e22, \u0e2d\u0e31\u0e07\u0e01\u0e24\u0e29 BBL PDF \u0e44\u0e17\u0e22, \u0e2d\u0e31\u0e07\u0e01\u0e24\u0e29 SCB PDF \u0e44\u0e17\u0e22, \u0e2d\u0e31\u0e07\u0e01\u0e24\u0e29"},{"location":"libraries/thanakan-statement/#pdf","title":"\u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19 PDF","text":"<p>Statement PDF \u0e2a\u0e48\u0e27\u0e19\u0e43\u0e2b\u0e0d\u0e48\u0e21\u0e35\u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19\u0e40\u0e1b\u0e47\u0e19\u0e27\u0e31\u0e19\u0e40\u0e14\u0e37\u0e2d\u0e19\u0e1b\u0e35\u0e40\u0e01\u0e34\u0e14 (DDMMYYYY):</p> <pre><code># \u0e23\u0e30\u0e1a\u0e38\u0e42\u0e14\u0e22\u0e15\u0e23\u0e07\nstatement = parse_pdf(\"statement.pdf\", password=\"02011995\")\n\n# \u0e43\u0e0a\u0e49 environment variable\nimport os\nos.environ[\"PDF_PASS\"] = \"02011995\"\nstatement = parse_pdf(\"statement.pdf\")\n</code></pre>"}]}